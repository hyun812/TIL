# 패키지 매니저란?

**프로젝트에 필요한 외부 라이브러리, 모듈, 플러그인 등을 패키지 관리를 용이하게 해주는 도구**

</br>

# 주요 기능

1. **의존성 관리**

   패키지 매니저는 프로젝트의 의존성을 관리함

   패키지는 다른 패키지에 의존할 수 있기 때문에 패키지 매니저는 이러한 의존성을 자동으로 해결하여 필요한 패키지들을 설치함

1. **버전 관리**

   패키지 매니저는 패키지의 다양한 버전을 관리함

   특정 버전의 패키지를 설치하거나 업데이트 할 수 있으며, 프로젝트가 정확한 버전의 패키지를 사용하도록 보장함

1. **스크립트 실행**

   패키지 매니저는 프로젝트에 미리 정의된 스크립트를 실행하는 기능을 제공함

   이를 통해 빌드, 테스트, 배포 등의 자동화된 작업을 수행할 수 있음

</br>

# 패키지 매니저 동작 방식

## 1. Resolution 단계

- 설치하려는 패키지의 버전과 그 패키지가 의존하는 모든 의존성 패키지의 버전을 결정
- 모든 기기에서 고정된 버전을 사용할 수 있도록 함
- 결과물을 `yarn.lock`이나 `package-lock.json`에 저장함

## 2. Fetch 단계

- 결정된 패키지 버전을 실제로 다운로드
- 레지스트리(예: npm 레지스트리)에서 필요한 패키지를 다운로드 진행

## 3. Link 단계

- Resolution/Fetch 된 라이브러리를 소스 코드에서 사용할 수 있는 환경을 제공하는 과정

### [1] npm Linker

- 다운로드된 패키지들은 프로젝트의 `node_modules` 디렉터리에 하나하나 배치
- `node_modules`를 계속 타고 올라가면서 파일을 여러 번 읽어야 하기 때문에 `import`나 `require`하는 속도가 느려지고 디렉토리 크기가 매우 커짐

### [2] pnpm Linker

- `node_modules` 디렉토리를 그대로 사용하지만 npm보다 빠르고 용량을 최적화하는 방식을 사용
- **Hard link**를 사용해 \*\*\*\*alias를 거는 방식으로 의존성이 디스크에 하나만 설치됨

### [3] PnP Linker (yarn)

- `node_modules` 디렉토리가 아닌 JavaScript Map 객체로 처리하는 방법
- `yarn.lock` 기반으로 `.pnp.cjs` 파일만 만들어서 쓰기 때문에 설치속도도 빠름
- `import`나 `require` 하는 속도가 `node_modules` 디렉토리를 순회하는 것이 아닌 Map 연산만 진행하기 때문에 매우 빠름
- Node.js 프로세스가 뜨는 속도가 느리고, `node_modules` 디렉토리와 호환성이 낮음
- **Zero-install**은 PnP의 JavaScript Map 객체와 Fetch된 의존성들까지 모두 GIt에 넣어 버전을 관리하자는 방식으로 디펜던시 Install에 걸리는 시간을 없앨 수 있음

|           | PnP(Plug and Play)                                                  | Zero-install                                                                                   |
| --------- | ------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------- |
| 주요 개념 | JavaScript Map 객체를 활용해 의존성을 관리함                        | 패키지 관리와 패치된 결과물을 모두 버전 관리 시스템(Git)에 포함시켜 설치 과정 생략             |
| 동작 방식 | .pnp.cjs 파일을 사용해 의존성 위치를 관리                           | 프로젝트의 의존성과 결과물을 저종소에 포함하여 설치 과정 없이 바로 사용                        |
| 사용 조합 | npm또는 Yarn PnP 모드에서 사용 가능                                 | npm방식, PnP방식 모두 사용 가능 (그렇지만 PnP방식만이 경제적)                                  |
| 장점      | 하나의 의존성만 설치되어 효율적, 설치 속도 향상, 디스크 사용량 감소 | 모든 의존성과 환경을 버전 관리하므로 일관성 있는 개발 환경 제공, 초기 설정 없이 빠른 시작 가능 |
| 단점      | 기존 툴링과의 호환성 문제, 설정 복잡성 증가                         | 의존성 업데이트 시 추가적인 관리 필요, 저장소 용량 증가 가능                                   |

</br>

# 대표 자바스크립트 패키지 매니저

## npm (Node Package Manager)

- Node.js 생태계의 가장 대표적인 패키지 매니저로 많은 개발자들이 널리 사용하고 있음
- 강력한 CLI 를 제공하여 패키지 설치, 버전 관리, 의존성 해결 등의 기능을 수행함
- 패키지 설치 시 패키지들을 각각 별도로 설치함. 이로 인해 공유된 의존성이 중복으로 설치될 수 있으며 의존성 트리가 깊어질수록 패키지 설치 속도가 느려지고, 디스크 공간을 많이 차지할 수 있음

## pnpm

- 성능 최적화와 **`디스크 공간 절약`**을 목표로 만들어진 패키지 매니저
- 하드링크와 심볼링 링크를 사용하여 중복된 패키지의 저장 공간을 줄이는 독특한 방식을 사용
- 동시 설치 기능을 지원하여 의존성 설치 속도를 향상시킴

## yarn

- Facebook에 의해 개발되었으며 npm의 단점을 보완하고 더 나은 성능과 안정성을 제공
- **`빠른 설치 속도와 안정성`**, 오프라인 캐시 기능 등을 제공함

</br>

# 정리하며

패키지 매니저는 소프트웨어 개발에서 필수적인 도구로 개발자의 생산성을 높이고, 프로젝트의 안정성과 성능을 보장하는데 중요한 역할을 함

따라서 각 패키지 매니저의 고유한 특징을 이해하고 선호도와 프로젝트의 특성을 고려해 가장 적합한 패키지 매니저를 선택하는 것이 중요함!!
